monitor=,preferred,auto,1

# TODO: Find out what this is.
env = XCURSOR_SIZE,24

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
}

input {
    kb_layout = us

    follow_mouse = 1

    touchpad {
        # Invert scroll direction, so that dragging up scrolls *down*.
        # I.e, what I'm used to from the Mac.
        natural_scroll = yes
    }

    sensitivity = 0 # -1.0 - 1.0, 0 means no modification.
}

general {
    layout = master

    gaps_in = 6
    gaps_out = 12

    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
}

decoration {
    rounding = 4

    blur {
        enabled = true
        size = 4
    }

    drop_shadow = yes
    shadow_range = 4
    shadow_render_power = 3
    col.shadow = rgba(1a1a1aee)
    dim_special = 0.8
}

animations {
    enabled = yes

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = windowsMove,0

    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

master {
    # Push new windows onto the stack and leave the master alone.
    new_is_master = false

    # Remove gaps and borders when there is only one window on the workspace.
    no_gaps_when_only = 1

    # Apply exact 50/50 split between master and stack.
    # The default is 0.55, making the master slightly wider than the stack.
    mfact = 0.5
}

gestures {
    workspace_swipe = off
}

#-------------------------------------------------------------------------------
# KEYS

$mod = SUPER
$alt_mod = $mod SHIFT

# Quit Hyprland
bind = $alt_mod, delete, exit,

# Close focused window
bind = $mod, backspace, killactive,

# Launch applications
bind = $mod, space, exec, tofi-drun | xargs hyprctl dispatch exec --
bind = $mod, T, exec, kitty
bind = $mod, B, exec, firefox
bind = $mod, E, exec, code

# Move focus (directional)
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d

# Cycle focus
bind = $mod, grave, cyclenext, prev
bind = $mod, semicolon, cyclenext, prev
bind = $mod, apostrophe, cyclenext

# Fullscreen focused window
bind = $mod, f, fullscreen

# Maximize focused window
bind = $mod, return, fullscreen, 1

# Toggle floating mode for focused window
bind = $alt_mod, return, togglefloating

# Swap windows
bind = $alt_mod, left, swapnext, prev
bind = $alt_mod, right, swapnext,

# Resize focused window
# TODO: Set mfact instead. I want to move the split point, not resize the window.
# And maybe just cycle backwards/forwards through a list of predefined split
# factors.
# Will need to write a script for this.
bind = $mod, comma, resizeactive, -20 0
bind = $mod, period, resizeactive, 20 0
# Reset split to center. Hardcoded and wrong.
bind = $mod, slash, resizeactive, exact 960 1030

# Go to previous/next workspace
bind = $mod, prior, workspace, -1
bind = $mod, next, workspace, +1

# Drag focused window to previous/next workspace
bind = $alt_mod, prior, movetoworkspace, -1
bind = $alt_mod, next, movetoworkspace, +1

# Switch workspace
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9

# Move focused window to workspace
bind = $alt_mod, 1, movetoworkspacesilent, 1
bind = $alt_mod, 2, movetoworkspacesilent, 2
bind = $alt_mod, 3, movetoworkspacesilent, 3
bind = $alt_mod, 4, movetoworkspacesilent, 4
bind = $alt_mod, 5, movetoworkspacesilent, 5
bind = $alt_mod, 6, movetoworkspacesilent, 6
bind = $alt_mod, 7, movetoworkspacesilent, 7
bind = $alt_mod, 8, movetoworkspacesilent, 8
bind = $alt_mod, 9, movetoworkspacesilent, 9

# Toggle general scratchpad
bind = $mod, bracketleft, togglespecialworkspace, gen1
bind = $mod, bracketright, togglespecialworkspace, gen2

# Move focused window to general scratchpad
bind = $alt_mod, bracketleft, movetoworkspacesilent, special:gen1
bind = $alt_mod, bracketright, movetoworkspacesilent, special:gen2

# Toggle terminal scratchpad
bind = $mod, backslash, togglespecialworkspace, term

# Spawn new scratchpad terminal
bind = $alt_mod, backslash, exec, kitty --title scratch!

#-------------------------------------------------------------------------------
# MEDIA KEYS

# Volume
bindle = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
bindle = , XF86AudioLowerVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%-
bindle = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindle = , XF86AudioMicMute, exec, pactl set-source-mute @DEFAULT_SOURCE@ toggle

# Brightness
bindle = , XF86MonBrightnessDown, exec, light -U 10
bindle = , XF86MonBrightnessUp, exec, light -A 10

#-------------------------------------------------------------------------------
# RULES

# Make terminal subtly transparent
windowrulev2 = opacity 0.9,class:^(kitty)$

# Silently move terminal entitled "scratch" to scratchpad
windowrulev2 = workspace special:term silent,class:^(kitty)$,title:^(scratch)$

# Loudly move terminal entitled "scratch!" to scratchpad
windowrulev2 = workspace special:term,class:^(kitty)$,title:^(scratch\!)$

#-------------------------------------------------------------------------------
# INIT

# Launch the bar
exec-once = waybar

# Set the wallpaper
exec-once = hyprpaper

# Start notification daemon
exec-once = mako

# Spawn two terminals onto the term scratchpad
exec-once = kitty --title scratch -d ~/sys
exec-once = kitty --title scratch -d ~/sys
